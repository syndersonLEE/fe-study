# ch9 단위 테스트

- 애자일과 TDD 덕에 단위 테스트를 자동화 하는 프로그래머들이 많아 졌다
- 제대로 된 테스트 케이스에 대한 요구 잊음

### TDD 법칙 세가지

TDD 단위 테스트 법칙

1. 실패하는 단위 테스트를 작성할 때 까지 실제 코드를 작성하지 않기
2. 컴파일은 실패하지 않으면서 실행만 실패하는 단위 테스트 작성
3. 현재 실패하는 테스트를 통과하는 실제 코드 작성

개발과 테스트가 30초 단위로 묶이기 떄문에 둘이 함께 나온지만, 이런 케이스는 방대하기 때문에 관리 문제를 유발하기도 한다

### 깨끗한 테스트 코드 유지

- 일회성 <-> 자동화 테스트 코드 사이에는 간격이 큼
- 테스트 코드가 늘어나면 리소스 부담이 커진다 -> But 코드가 없으면 테스트 슈트가 없으면 결함성을 증명하기 어려움 -> 코드가 망가짐
- 그러므로 테스트 코드는 실제 코드와 중요하고 그 깨끗함 또한 중요하다


##### 테스트는 1.유연성 2.유지보수성 3.재사용성을 제공

TC가 없으면 모든 변경은 잠재적 버그 -> 따라서 TC를 통해서 변경을 쉽게 만든다

### 깨끗한 테스트 코드

깨끗한 코드 = 가독성

테스트 코드에서는 <b>가독성</b>이 매우매우 중요

따라서 Build - Operate - Check 패턴이 테스트 구조의 적합

또한 세세한 코드를 제거하여 반드시 필요한 함수만 기입

##### 도메인에 특화된 언어

DSL로 테스트 코드를 구현하는 기법은 좋음 -> 잡다하고 세세한 API 위에 가독성 좋은 코드로 덮어버리기 때문에 읽기가 좋다

##### 이중 표준

테스트 API의 표준은 일반 코드와 결이 다름
- 일반 코드와 같을 필요성은 없음
- 잘못된 정보를 기입하더라도 메모리와 CPU의 환경은 고려하지 않고 풍부하고 가독성 좋은 코드가 좋음

### 테스트 당 assert 하나

- JUnit으로 테스트를 짤 때는, assert 문이 하나 초과해서 쓰지 않는 것을 권장 -> 하나의 함수는 하나의 결론을 내야함
- Give-When-Then 방식으로 코드를 작성하는 것은 좋지만, assert를 1개만 쓰기 위해서 각자가 수행할 경우 중복되는 코드가 많아짐 -> 이 때, 템플릿 메소드 패턴을 활용
    - Given-When 부분을 부모 클래스에 두고, then 부분을 자식 클래스에 둔다
    - @Before 함수에 given/when 부분을 넣고 @Test에 then을 넣음

##### 테스트 당 개념 하나

테스트 함수 하나 당 하나의 개념만 테스트를 해야함

### F.I.R.S.T

깨끗한 테스트는 다섯 가지 규칙을 따름

- Fast : 테스트는 빨라야 한다 -> 느리면 자주 못 돌린다
- Independent : 테스트에 서로 의존하면 안된다 -> 서로에게 의존하면 하나가 실패하면 다 실패
- Repeatable : 테스트는 어떤 환경에서든 돌아가야 한다 -> 기기에 다른 문제가 생기는 건 X
- Self-Validating : 테스트는 결과 값이 Boolean으로 답이 나와야 한다 -> 로그를 직접 파본다라는건 수작업 & 판단의 주관성이 들어간다
- Timely : 테스트는 적시에 적성되어야 테스트 자체에 대한 접근성이 높아진다